{% load static %}
<html>
    <head>
        <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
    </head>
    <body>
        <div style="position: absolute; background-repeat:no-repeat; background-size: cover; min-width: 100%; min-height: 100%; background-image: url('/media/irctc-img.jpeg'); opacity: 0.4;">
            
        </div>
        <div style="min-width: 100%; padding: 50px; font-size: large; border: 1px black; position: absolute; z-index: 999;">
            <div class="form-group col-md-4">
                <label for="origin">Available Balance:</label>
                <input class="form-control" type="text" value="{{balance}}" readonly>
            </div>
            <form action="/journey/book/" method="POST">
                {% csrf_token %}
                <div class="form-row">
                    <div class="form-group col-md-4">
                        <label for="origin">From :</label>
                        <select id="origin" name="origin" class="form-control">
                            {% for station in stations %}
                                <option value="{{station.id}}">{{station.code}} - {{station.name}}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <br />
                <div class="form-row">
                    <div class="form-group col-md-4">
                        <label for="destination">To :</label>
                        <select id="destination" name="destination" class="form-control">
                            {% for station in stations %}
                                <option value="{{station.id}}">{{station.code}} - {{station.name}}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <br />
                <br />
                <button type="button" onclick="get_ticket_price()" class="btn btn-secondary">Get Price</button>
                <button type="submit" class="btn btn-primary">Book</button>
            </form>
            <div class="form-group col-md-4">
                <label for="ticket_price">Ticket Price:</label>
                <input class="form-control" id="ticket_price" type="text" value="0" readonly>
            </div>
            <script>

                function get_ticket_price(){
                    var origin = $('#origin option:selected').attr('value');
                    var destination = $('#destination option:selected').attr('value');
                    if (origin==destination) return 0;
                    $.ajax({
                        url: "/journey/ticket/price/",
                        type: 'GET',
                        data: {
                            origin: origin,
                            destination: destination
                        },
                        success: function(res) {
                            $("#ticket_price").val(res['price'])
                        }
                    });
                }

            </script>
        </div>
    </body>
</html> 
